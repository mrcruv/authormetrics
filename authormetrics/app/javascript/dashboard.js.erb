var actual_chart="chart1";
var charts= [
    document.getElementById("chart1"),
    document.getElementById("chart2"),
    document.getElementById("chart3"),
    document.getElementById("chart4"),
    document.getElementById("chart5"),
    document.getElementById("chart6")];

function favorite_authors_graph(){
    document.getElementById(actual_chart).style.visibility = "hidden";
    actual_chart= "chart1";
    document.getElementById(actual_chart).style.visibility= "visible";
}

function auth_ratings_graph_rate(){
    document.getElementById(actual_chart).style.visibility = "hidden";
    actual_chart= "chart2";
    document.getElementById(actual_chart).style.visibility= "visible";
}

function comments_graph_rate(){
    document.getElementById(actual_chart).style.visibility = "hidden";
    actual_chart= "chart3";
    document.getElementById(actual_chart).style.visibility= "visible";
}

function pub_ratings_graph_rate(){
    document.getElementById(actual_chart).style.visibility = "hidden";
    actual_chart= "chart5";
    document.getElementById(actual_chart).style.visibility= "visible";
}

function reviews_graph(){
    document.getElementById(actual_chart).style.visibility = "hidden";
    actual_chart= "chart6";
    document.getElementById(actual_chart).style.visibility= "visible";
}

function initializeCharts(){
    <!-- CHART 1-->
    <!-- END CHART 1-->

    <!-- CHART 4-->
    <%most_cited_pubs_per_year_data= []%>

    <%for year in (Date.today.year - 10.. Date.today.year )%>
    <%most_cited=Publication.distinct.order(cited_by: :desc).where(pub_year:year).first()%>
        <%if (most_cited != nil)%>
            <%most_cited_pubs_per_year_data << [ year.to_s + ": "+  most_cited.title, most_cited.cited_by]%>
        <%end%>
    <%end%>
    var chart= new Chartkick.ColumnChart("most_cited_pubs_per_year_chart",<%=most_cited_pubs_per_year_data%>,
    {colors: ["#97f6b0", "#80e7ad", "#69d8ab", "#55c8a7", "#41b9a3", "#2fa99d", "#1f9a96", "#0f8a8f","#037b86", "#006c7b" ], 
            title:"MOST CITED PUBLICATIONS IN 10 YEARS"});
    <!--END CHART 4-->
}

function changeChart1(){
   alert("CIAO");
}

function changeChart4(){
    var n= document.getElementById("last_n").value;
    if (n==5) changeChart4_5();
    else if (n==10) changeChart4_10();
    else if (n==15) changeChart4_15()
    else changeChart4_20()
}

function changeChart4_5(){
    <%most_cited_pubs_per_year_data= []%>

    <%for year in (Date.today.year - 5.. Date.today.year )%>
    <%most_cited=Publication.distinct.order(cited_by: :desc).where(pub_year:year).first()%>
        <%if (most_cited != nil)%>
            <%most_cited_pubs_per_year_data << [ year.to_s + ": "+  most_cited.title, most_cited.cited_by]%>
        <%end%>
    <%end%>

    var chart= new Chartkick.ColumnChart("most_cited_pubs_per_year_chart",<%=most_cited_pubs_per_year_data%>,
    {colors: ["#97f6b0", "#80e7ad", "#69d8ab", "#55c8a7", "#41b9a3", "#2fa99d", "#1f9a96", "#0f8a8f","#037b86", "#006c7b" ], 
            title:"MOST CITED PUBLICATIONS IN 5 YEARS"});
}

function changeChart4_10(){
    <%most_cited_pubs_per_year_data= []%>

    <%for year in (Date.today.year - 10.. Date.today.year )%>
    <%most_cited=Publication.distinct.order(cited_by: :desc).where(pub_year:year).first()%>
        <%if (most_cited != nil)%>
            <%most_cited_pubs_per_year_data << [ year.to_s + ": "+  most_cited.title, most_cited.cited_by]%>
        <%end%>
    <%end%>

    var chart= new Chartkick.ColumnChart("most_cited_pubs_per_year_chart",<%=most_cited_pubs_per_year_data%>,
    {colors: ["#97f6b0", "#80e7ad", "#69d8ab", "#55c8a7", "#41b9a3", "#2fa99d", "#1f9a96", "#0f8a8f","#037b86", "#006c7b" ], 
            title:"MOST CITED PUBLICATIONS IN 10 YEARS"});
}

function changeChart4_15(){
    <%most_cited_pubs_per_year_data= []%>

    <%for year in (Date.today.year - 15.. Date.today.year )%>
    <%most_cited=Publication.distinct.order(cited_by: :desc).where(pub_year:year).first()%>
        <%if (most_cited != nil)%>
            <%most_cited_pubs_per_year_data << [ year.to_s + ": "+  most_cited.title, most_cited.cited_by]%>
        <%end%>
    <%end%>

    var chart= new Chartkick.ColumnChart("most_cited_pubs_per_year_chart",<%=most_cited_pubs_per_year_data%>,
    {colors: ["#97f6b0", "#80e7ad", "#69d8ab", "#55c8a7", "#41b9a3", "#2fa99d", "#1f9a96", "#0f8a8f","#037b86", "#006c7b" ], 
            title:"MOST CITED PUBLICATIONS IN 15 YEARS"});
}

function changeChart4_20(){
    <%most_cited_pubs_per_year_data= []%>

    <%for year in (Date.today.year - 20.. Date.today.year )%>
    <%most_cited=Publication.distinct.order(cited_by: :desc).where(pub_year:year).first()%>
        <%if (most_cited != nil)%>
            <%most_cited_pubs_per_year_data << [ year.to_s + ": "+  most_cited.title, most_cited.cited_by]%>
        <%end%>
    <%end%>

    var chart= new Chartkick.ColumnChart("most_cited_pubs_per_year_chart",<%=most_cited_pubs_per_year_data%>,
    {colors: ["#97f6b0", "#80e7ad", "#69d8ab", "#55c8a7", "#41b9a3", "#2fa99d", "#1f9a96", "#0f8a8f","#037b86", "#006c7b" ], 
            title:"MOST CITED PUBLICATIONS IN 20 YEARS"});
}

function showFavPub(){
    var pub= document.getElementById('favorite_pub').value;
    const url="https://127.0.0.1:3000/publications/"+pub;
    window.location.href = url;
}

function showFavAuth(){
    var auth= document.getElementById('favorite_auth').value;
    const url="https://127.0.0.1:3000/authors/"+auth;
    window.location.href = url;
}

function editFavPub(user_id){
    const url="https://127.0.0.1:3000/users/"+ user_id+ "/favorite_publications";
    window.location.href = url;
} 

function editFavAuth(user_id){
    const url="https://127.0.0.1:3000/users/"+ user_id+ "/favorite_authors"
    window.location.href = url;
} 




